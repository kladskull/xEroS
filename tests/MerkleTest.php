<?php declare(strict_types=1);

namespace Xeros;

use PHPUnit\Framework\TestCase;
use RichJenks\Merkle\Merkle;

class MerkleTest extends TestCase
{
    private Merkle $merkle;

    protected function setUp(): void
    {
        $this->merkle = new Merkle();
    }

    public function testMerkleTree(): void
    {
        $transactionIds = [
            '00000000000000000000000000000000000000000000000000000000000000000000000000000000',
            '00000000000000000000000000000000000000000000000000000000000000000000000000000001',
            '00000000000000000000000000000000000000000000000000000000000000000000000000000002',
            '00000000000000000000000000000000000000000000000000000000000000000000000000000003',
            '00000000000000000000000000000000000000000000000000000000000000000000000000000004',
            '00000000000000000000000000000000000000000000000000000000000000000000000000000005',
            '00000000000000000000000000000000000000000000000000000000000000000000000000000006',
            '00000000000000000000000000000000000000000000000000000000000000000000000000000007',
            '00000000000000000000000000000000000000000000000000000000000000000000000000000008',
            '00000000000000000000000000000000000000000000000000000000000000000000000000000009',
            '10000000000000000000000000000000000000000000000000000000000000000000000000000000',
            '20000000000000000000000000000000000000000000000000000000000000000000000000000000',
            '30000000000000000000000000000000000000000000000000000000000000000000000000000000',
            '40000000000000000000000000000000000000000000000000000000000000000000000000000000',
            '50000000000000000000000000000000000000000000000000000000000000000000000000000000',
            '60000000000000000000000000000000000000000000000000000000000000000000000000000000',
            '70000000000000000000000000000000000000000000000000000000000000000000000000000000',
            '80000000000000000000000000000000000000000000000000000000000000000000000000000000',
            '90000000000000000000000000000000000000000000000000000000000000000000000000000000',
        ];

        $root = Merkle::root($transactionIds);
        $this->assertEquals('B81857E74772EEB53DB05BB7100B3744B0D58864F0D4C808F3FB7F9D2693CE11', $root);
        $this->assertTrue(Merkle::verify($root, $transactionIds));
    }

    public function testMerkleTreeWithOne(): void
    {
        $transactionIds = [
            '001122445566778899AABBCCDDEEFF001122445566778899AABBCCDDEEFF001122445566778899AABBCCDDEEFF',
        ];

        $root = Merkle::root($transactionIds);
        $this->assertEquals('222715156494036C52A498597623C6132F4B7E9B58E83952E9F8E270874A751B', $root);
        $this->assertTrue(Merkle::verify($root, $transactionIds));
    }

}
